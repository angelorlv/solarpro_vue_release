(function(e){function t(t){for(var a,l,r=t[0],o=t[1],c=t[2],d=0,p=[];d<r.length;d++)l=r[d],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&p.push(i[l][0]),i[l]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);u&&u(t);while(p.length)p.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],a=!0,r=1;r<s.length;r++){var o=s[r];0!==i[o]&&(a=!1)}a&&(n.splice(t--,1),e=l(l.s=s[0]))}return e}var a={},i={index:0},n=[];function l(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.m=e,l.c=a,l.d=function(e,t,s){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(s,a,function(t){return e[t]}.bind(null,a));return s},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=o;n.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},1:function(e,t){},1384:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"p-2"},[s("div",{},[s("span",{staticClass:"text-2xl"},[e._v("Accueil")])])])}],n={data:function(){return{}}},l=n,r=s("2877"),o=Object(r["a"])(l,a,i,!1,null,null,null);t["default"]=o.exports},1787:function(e,t,s){"use strict";s("5ebe")},"393f":function(e,t,s){},"3bd8":function(e,t,s){},4360:function(e,t,s){"use strict";s.r(t);var a=s("2f62"),i=new a["default"].Store({state:{user:{},status_connect:!1},getters:{getUser:function(e){return e.user}},mutations:{setUser:function(e,t){e.user=t,e.status_connect=!0},deconnect:function(e){e.status_connect=!1}}});t["default"]=i},"4efb":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[0==e.list_length?s("div",{staticClass:"p-5 flex justify-center items-center"},[s("span",{},[e._v("Aucune statistique à Afficher")])]):e._e(),e.list_length>0?s("div",{},[s("div",{},[s("div",{staticClass:"border-b justify-center items-center mb-2 p-2  flex  text-xl"},[s("span",{staticClass:"flex-grow"},[e._v(" Statistique du "),s("span",{staticClass:"font-bold"},[e._v(e._s(e.date_lettre))])]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.date_select,expression:"date_select"}],staticClass:"text-md input",attrs:{type:"date"},domProps:{value:e.date_select},on:{input:function(t){t.target.composing||(e.date_select=t.target.value)}}})]),e._l(e.places_stat,(function(t,a){return s("div",{key:a,staticClass:"flex rounded items-center border m-2 duration-300 hover:bg-gray-300 hover:bg-opacity-30"},[s("div",{staticClass:"p-2 h-full bg-gray-200"},[t.visited?s("span",{staticClass:"flex justify-center items-center text-green-500 material-icons"},[e._v(" check_circle ")]):s("span",{staticClass:"flex justify-center items-center text-red-500 material-icons"},[e._v(" unpublished ")])]),s("div",{staticClass:"mx-2 flex flex-col"},[s("router-link",{staticClass:"font-bold",attrs:{to:{name:"vue_emplacement",params:{id:a}}}},[e._v(e._s(t.label))]),t.visited?s("div",{staticClass:"flex"},[s("span",{staticClass:"px-2"},[e._v(" Par : "+e._s(t.user)+" ")]),s("div",{staticClass:"border-l px-2"},[e._v(" A partir de : "),s("span",{staticClass:"font-bold"},[e._v(e._s(parseInt(t.time.enter[0])+3+"H."+t.time.enter[1]+"M."+t.time.enter[2])+" ")]),e._v(" à "),s("span",{staticClass:"font-bold"},[e._v(" "+e._s(parseInt(t.time.exit[0])+3+"H."+t.time.exit[1]+"M."+t.time.exit[2])+" ")])]),s("div",{},[e._v(" Durée Contrôle : "),s("span",{staticClass:"font-bold"},[e._v(" "+e._s(t.duree>=60?t.duree%60:t.duree)+" ")]),e._v(" "),s("span",[e._v(" "+e._s(t.duree>=60?"Minutes":"Secondes")+" ")])])]):e._e()],1),s("div",{staticClass:"border-l"})])}))],2)]):e._e()])},i=[],n=(s("ac1f"),s("1276"),s("5319"),s("fb6a"),s("d81d"),{watch:{date_select:function(e){var t=e.split("-");this.date_lettre=t[2]+" "+this.mois[parseInt(t[1])-1]+" "+t[0],this.recup_stat_par_jour()}},data:function(){return{places_stat:{},list_length:0,date_now:"",date_select:(new Date).toISOString().slice(0,19).replace("T"," ").split(" ")[0],date_lettre:"",mois:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"]}},methods:{recup_stat_par_jour:function(){var e=this;this.$http.get("a/places/stat?date_check="+this.date_select).then((function(t){t.body.status?(e.list_length=t.body.places_stat.length,e.format_par_jour(t.body.places_stat)):alert(t.body.message)}),(function(e){}))},format_par_jour:function(e){this.places_stat={};for(var t=0;t<e.length;t++){this.places_stat[e[t].place_id]||(this.places_stat[e[t].place_id]={});var s={};s.enter=null!=e[t].time_enter?e[t].time_enter.split(":"):null,s.exit=null!=e[t].time_exit?e[t].time_exit.split(":"):null;var a={time:s,user:null!=s.enter&&null!=s.exit?e[t].login:null,label:e[t].label};if(null==s.enter||null==s.exit)a.visited=!1,a.duree=null;else{a.visited=!0;var i=s.enter.map((function(e){return parseInt(e)})),n=s.exit.map((function(e){return parseInt(e)}));i=60*i[0]*60+60*i[1]+i[2],n=60*n[0]*60+60*n[1]+n[2];var l=n-i;a.duree=l}e[t].date_check!=this.date_select&&(a.visited=!1),this.places_stat[e[t].place_id]=a}console.log(this.places_stat)}},mounted:function(){this.date_now=(new Date).toISOString().slice(0,19).replace("T"," ").split(" ")[0];var e=this.date_now.split("-");this.date_lettre=e[2]+" "+this.mois[parseInt(e[1])-1]+" "+e[0],this.recup_stat_par_jour()}}),l=n,r=s("2877"),o=Object(r["a"])(l,a,i,!1,null,null,null);t["default"]=o.exports},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-col justify-center items-center bg-gray-200 h-screen w-screen",attrs:{id:"app"}},[s("transition",{attrs:{name:"fade",mode:"out-in"}},[e.data_loaded?s("div",{},[e.$store.state.status_connect?s("div",{staticClass:"w-screen h-screen max-h-screen"},[s("contents")],1):s("div",{staticClass:"w-screen"},[s("login")],1)]):e._e()])],1)},i=[],n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex h-screen w-screen"},[s("sidebar"),s("div",{staticClass:"h-screen max-h-screen overflow-auto bg-gray-100 w-screen border-l border-blue-200"},[s("router-view")],1)],1)},l=[],r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-screen max-h-screen flex flex-col overflow-auto",style:e.sidebar_style},[s("div",{staticClass:"p-2 border-b  border-gray-300 text-gray-700"},[e._m(0),s("div",{staticClass:"flex justify-center items-center"},[s("div",{staticClass:"flex-grow "},[s("span",[e._v("Bonjour, ")]),s("span",{staticClass:"font-bold"},[e._v(e._s(e.$store.state.user.login))])]),s("button",{staticClass:"bt rounded-full flex justify-center items-center",on:{click:e.deconnexion}},[s("span",{staticClass:"material-icons"},[e._v(" logout ")])])])]),s("div",{staticClass:"p-2"},[s("router-link",{staticClass:"menu_sidebar",attrs:{to:{name:"home"}}},[s("span",{staticClass:"material-icons"},[e._v(" home ")]),s("span",{staticClass:"ml-5"},[e._v(" Accueil ")])]),s("router-link",{staticClass:"menu_sidebar",attrs:{to:{name:"emplacement"}}},[s("span",{staticClass:"material-icons text-blue-700"},[e._v(" place ")]),s("span",{staticClass:"ml-5"},[e._v(" Emplacement ")])]),s("router-link",{staticClass:"menu_sidebar",attrs:{to:{name:"stat"}}},[s("span",{staticClass:"material-icons text-pink-700"},[e._v(" analytics ")]),s("span",{staticClass:"ml-5"},[e._v(" Statistiques ")])]),s("router-link",{staticClass:"menu_sidebar",attrs:{to:{name:"user"}}},[s("span",{staticClass:"material-icons"},[e._v(" face ")]),s("span",{staticClass:"ml-5"},[e._v(" Utilisateur ")])]),s("router-link",{staticClass:"menu_sidebar",attrs:{to:{name:"settings"}}},[s("span",{staticClass:"material-icons"},[e._v(" settings ")]),s("span",{staticClass:"ml-5"},[e._v(" Paramètres ")])])],1)])},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{},[s("span",{staticClass:"text-3xl"},[e._v(" Solarpro ")]),e._v(" "),s("span",{staticClass:"text-xl"},[e._v("Admin")])])}],c={data:function(){return{sidebar_style:{minWidth:"250px"}}},methods:{deconnexion:function(){var e=this;this.$http.get("a/deconnect").then((function(t){t.body.status?e.$store.commit("deconnect"):alert(t.body.message)}),(function(e){}))}}},u=c,d=s("2877"),p=Object(d["a"])(u,r,o,!1,null,null,null),m=p.exports,f={components:{sidebar:m},data:function(){return{}},created:function(){console.log(this.$route)}},_=f,v=Object(d["a"])(_,n,l,!1,null,null,null),h=v.exports,b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex w-full "},[s("div",{staticClass:"flex flex-col justify-center bg-green-400 items-center h-screen pl-5 duration-300",class:{"w-full":"about"==e.state,hidden:"login"==e.state},on:{click:function(t){return e.change_state("about")}}},[s("span",{staticClass:"font-bold text-gray-700 text-7xl"},[e._v("Solarpro")]),s("span",{staticClass:"font-bold text-gray-600 pl-5 text-5xl"},[e._v("Admin")]),"about"==e.state?s("button",{staticClass:"bt rounded-full animate-bounce mt-5",on:{click:function(t){return e.change_state("login")}}},[e._v("Connexion")]):e._e()]),s("div",{staticClass:"duration-300 h-screen w-1/2 flex flex-col justify-center items-center bg-gray-100 border-l border-blue-200",class:{"w-full":"login"==e.state,"hidden opacity-50":"about"==e.state},on:{click:function(t){return e.change_state("login")}}},[s("form",{staticClass:"flex flex-col justify-center items-center",attrs:{action:"/",method:"post"},on:{submit:function(t){return t.preventDefault(),e.connect.apply(null,arguments)}}},[e._m(0),s("div",{staticClass:"duration-300 h-2 z-0",class:{"h-14":e.msg_info.active}},[s("transition",{attrs:{name:"fade"}},[e.msg_info.active?s("div",{staticClass:" p-2 rounded border",class:{"bg-red-500":!e.msg_info.success,"bg-green-500":e.msg_info.success}},[s("span",[e._v(" "+e._s(e.msg_info.message)+" ")])]):e._e()])],1),s("div",{staticClass:"my-2"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.login,expression:"user.login"}],staticClass:"input",attrs:{id:"u_login",type:"text",placeholder:"Identifiant"},domProps:{value:e.user.login},on:{input:function(t){t.target.composing||e.$set(e.user,"login",t.target.value)}}})]),s("div",{staticClass:"my-2"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.pass,expression:"user.pass"}],staticClass:"input",attrs:{id:"u_pass",type:"password",placeholder:"Mot de passe ..."},domProps:{value:e.user.pass},on:{input:function(t){t.target.composing||e.$set(e.user,"pass",t.target.value)}}})]),e._m(1)])])])},g=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"border-b pb-3 mb-2 "},[s("span",{staticClass:"text-3xl"},[e._v(" Solarpro ")]),e._v(" "),s("span",{staticClass:"text-xl"},[e._v("Admin")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"my-2 justify-center flex"},[s("button",{staticClass:"bt rounded-full duration-300"},[e._v("Connexion")])])}],x={data:function(){return{user:{login:"",pass:""},error_login:{isOn:!1,message:""},msg_info:{active:!1,success:!1,message:""},id_time_out:-1,state:"login"}},methods:{connect:function(){var e=this;this.$http.post("p/auth",this.user).then((function(t){t.body.status?(e.show_msg_info(t.body.message,!0),e.$store.commit("setUser",t.body.user),setTimeout((function(){}),1e3)):(document.querySelector("#u_login").focus(),e.show_msg_info(t.body.message))}),(function(e){}))},show_msg_info:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.msg_info.active=!0,this.msg_info.message=e,this.msg_info.success=t;var s=this;-1!=this.id_time_out&&clearTimeout(this.id_time_out),this.id_time_out=setTimeout((function(){s.msg_info.active=!1,s.msg_info.message="",s.id_time_out=-1}),2e3)},change_state:function(e){"login"==e&&"login"!=this.state&&document.querySelector("#u_login").focus(),this.state=e}}},y=x,C=(s("a968"),Object(d["a"])(y,b,g,!1,null,"f83e795a",null)),w=C.exports,k={data:function(){return{d:"",data_loaded:!1}},name:"App",components:{login:w,contents:h},methods:{test_recup_data:function(){this.$http.get("p/test").then((function(e){console.log(e)}),(function(e){}))},check_connect:function(){var e=this;this.$http.get("a/check_connect").then((function(t){t.body.status?e.$store.commit("setUser",t.body.user):e.$store.commit("deconnect"),e.data_loaded=!0}),(function(e){}))}},created:function(){this.check_connect()}},j=k,$=(s("1787"),Object(d["a"])(j,a,i,!1,null,"1b21ddea",null)),O=$.exports,T=s("1157"),L=s.n(T),E=s("8c4f"),M=(s("845f"),s("755e")),P=s("2b0e").default,I=s("28dd").default,N=s("2f62").default,S=s("e26c").default;P.use(I),P.use(N),P.use(E["a"]),window.$=L.a,P.use(M,{load:{key:"AIzaSyBUADJkgRWIVtbeUlZlJ2oqEX_SU9xaQo4",libraries:"places"}}),P.config.productionTip=!1,P.http.options.root="/api",P.http.headers.common["Authorization"]="Basic YXBpOnBhc3N3b3Jk";var A=s("4360").default;new P({store:A,router:S,render:function(e){return e(O)}}).$mount("#app")},"56d9":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div")},i=[],n={data:function(){return{}}},l=n,r=s("2877"),o=Object(r["a"])(l,a,i,!1,null,null,null);t["default"]=o.exports},"5ebe":function(e,t,s){},"6fb8":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"p-2"},[s("div",{},[s("div",{staticClass:"border-b mb-3 flex justify-center items-center pb-2"},[s("span",{staticClass:"text-xl text-gray-700 flex-grow"},[e._v(" Liste des emplacements - ")]),s("button",{staticClass:"ml-2 bt rounded-full flex justify-center items-center",on:{click:function(t){return e.show_add_place(!0)}}},[s("span",{staticClass:"material-icons"},[e._v(" add ")]),s("span",[e._v(" Ajouter ")])])]),s("div",{},[0!=e.places.list.length?s("div",{},[s("div",{staticClass:"mb-2 sticky top-0 bg-gray-100 border-b shadow-lg p-2"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.search,expression:"search",modifiers:{trim:!0}}],staticClass:"input",attrs:{type:"text",placeholder:"Rechercher une place ..."},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),s("ctable",{attrs:{search:e.search,col_search:"label",_head:e.places.head,_list:e.places.list,_key:"id"},on:{on_delete:e.delete_place,on_view:e.view_place}})],1):s("div",{staticClass:"w-full flex justify-center items-center"},[s("span",{staticClass:"text-xl text-gray-600"},[e._v(" Aucun emplacement à afficher. ")])])])]),e.on_add_place?s("div",{staticClass:"fixed flex justify-center items-center top-0 left-0 w-screen h-screen bg-gray-800 bg-opacity-80"},[s("div",{staticClass:"bg-gray-100 border flex flex-col border-green-400 rounded shadow-lg",style:{minWidth:"400px",width:"900px",height:"500px"}},[s("div",{staticClass:"border-b p-2 bg-green-400 flex"},[s("span",{staticClass:"flex-grow text-2xl text-gray-700 font-bold"},[e._v("Ajout d'un emplacement")]),s("button",{staticClass:"w-8 h-8 rounded-full flex justify-center items-center text-gray-600\n                 hover:text-gray-800 duration-300",on:{click:function(t){return e.show_add_place(!1)}}},[s("span",{staticClass:"material-icons"},[e._v("clear")])])]),s("div",{staticClass:"flex w-full"},[s("div",{staticClass:"flex-grow",staticStyle:{width:"100%"}},[s("LeafletMap",{attrs:{places:e.places.list,radius:e.places.model.radius},on:{position:e.position,place_name:e.place_name}})],1),s("div",{key:"",staticClass:"flex flex-col justify-center items-center "},[s("div",{staticClass:"duration-300 h-0 flex justify-center items-center",class:e.info.isOn?"h-14":"h-0"},[e.info.isOn?s("div",{staticClass:"rounded p-2 ",class:e.info.success?"bg-green-400":"bg-red-400"},[s("span",[e._v(" "+e._s(e.info.message)+" ")])]):e._e()]),s("form",{staticClass:"flex flex-col ",attrs:{action:"/",method:"post"},on:{submit:function(t){return t.preventDefault(),e.post_add_place.apply(null,arguments)}}},[s("div",{staticClass:"mt-2 p-2 flex flex-col justify-end"},[s("div",{staticClass:"flex flex-col pr-2"},[s("div",{staticClass:"mt-1 flex flex-col"},[s("span",{staticClass:"text-sm text-gray-600"},[e._v(" Latitude et Longitude ... ")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.places.model.latlng,expression:"places.model.latlng",modifiers:{trim:!0}}],staticClass:"input",attrs:{type:"text",placeholder:"@exemple  -14.545454545, 48.15465445646546 ..."},domProps:{value:e.places.model.latlng},on:{input:function(t){t.target.composing||e.$set(e.places.model,"latlng",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),s("div",{staticClass:"mt-1 flex flex-col"},[s("span",{staticClass:"text-sm text-gray-600"},[e._v(" Rayon (en mètre) ... ")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.places.model.radius,expression:"places.model.radius",modifiers:{trim:!0}}],staticClass:"input",attrs:{type:"number",placeholder:"@exemple 50 ..."},domProps:{value:e.places.model.radius},on:{input:function(t){t.target.composing||e.$set(e.places.model,"radius",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),s("div",{staticClass:"mt-1 flex flex-col"},[s("span",{staticClass:"text-sm text-gray-600"},[e._v(" Libellé ... ")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.places.model.label,expression:"places.model.label",modifiers:{trim:!0}}],staticClass:"input",attrs:{type:"text",placeholder:"@exemple Analakely ..."},domProps:{value:e.places.model.label},on:{input:function(t){t.target.composing||e.$set(e.places.model,"label",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])])]),e._m(0)])])])])]):e._e()])},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"p-2 border-t flex justify-end"},[s("button",{staticClass:"bt rounded-full flex justify-center items-center"},[s("span",{staticClass:"material-icons"},[e._v("add_circle")]),s("span",[e._v("Créer")])])])}],n=s("ae38"),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"map"}})},r=[],o=s("4f96"),c=s("1da1"),u=(s("96cf"),s("d81d"),s("ac1f"),s("1276"),s("b0c0"),s("fb6a"),s("99af"),s("d3b7"),s("159b"),s("e11e")),d=s.n(u),p=(s("6cc5"),s("e192"),s("885b"),s("5c7a"),s("067d"),{props:["radius","places"],watch:{radius:function(e){this.circle_l.setRadius(e)}},components:{},data:function(){return{_radius:50,accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA",circle_l:null,features_circle:null,origin_view:[-18.929670491513264,47.52685546875001],mymap:{}}},methods:{initmap:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=e,e.mymap=d.a.map("map").setView(e.origin_view,16),d.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA"}).addTo(e.mymap),e.mymap.dragging.enable(),e.features_circle=d.a.featureGroup().addTo(e.mymap),d.a.Control.geocoder({defaultMarkGeocode:!1}).addTo(e.mymap).on("markgeocode",(function(t){console.log(t.geocode),s.features_circle.clearLayers(),s.circle_l=d.a.circle(t.geocode.center,{color:"red",fillColor:"#f03",fillOpacity:.5,draggable:!0,radius:s.radius}).addTo(e.features_circle),e.mymap.setView(t.geocode.center,16),s.$emit("position",t.geocode.center);var a=t.geocode.name.split(","),i=Object(o["a"])(a),n=i[0],l=i[1];i.slice(2);e.location=n+","+l,e.$emit("place_name",e.location)})),e.mymap.on("click",(function(t){s.features_circle.clearLayers(),s.circle_l=d.a.circle(t.latlng,{color:"red",fillColor:"#f03",fillOpacity:.5,radius:s.radius}).addTo(e.features_circle),s.$emit("position",t.latlng),s.getLocation(t.latlng)}));case 7:case"end":return t.stop()}}),t)})))()},getLocation:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var a,i,n,l,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,t.$http.get("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(e.lng,",").concat(e.lat,".json?access_token=").concat(t.accessToken));case 3:a=s.sent,i=a.data.features[0].place_name.split(","),n=Object(o["a"])(i),l=n[1],r=n[2],n.slice(3),t.location=l+","+r,t.$emit("place_name",t.location),s.next=12;break;case 9:s.prev=9,s.t0=s["catch"](0),console.log(s.t0);case 12:case"end":return s.stop()}}),s,null,[[0,9]])})))()},display_all_place:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=d.a.featureGroup().addTo(e.mymap),a={},i={},e.places.forEach((function(e){a=d.a.circle([e.lat,e.lng],{color:"green",fillColor:"green",fillOpacity:.5,radius:e.radius}).addTo(s),i=new d.a.Popup({autoClose:!1,closeOnClick:!1}).setContent(e.label).setLatLng([e.lat,e.lng]),a.bindPopup(i),a.openPopup(i)}));case 4:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.initmap(),this.display_all_place()}}),m=p,f=(s("ffad"),s("2877")),_=Object(f["a"])(m,l,r,!1,null,"b8e64600",null),v=_.exports,h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"relative"},[s("button",{staticClass:"p-2 bt-select rounded border cursor-pointer bg-white",on:{blur:e.hide,click:e.show}},[e._v(" "+e._s(e.selected[e.label]+" "+(void 0!=e.label2?e.selected[e.label2]:""))+" ")]),e.clicked?s("div",{staticClass:"cselect-list bg-white shadow-lg absolute  rounded border top-0 z-40",on:{mouseover:function(t){return e.hover(!0)},mouseleave:function(t){return e.hover(!1)}}},[void 0!=e.search?s("div",{staticClass:"p-2"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.search_text,expression:"search_text",modifiers:{trim:!0}}],staticClass:"input",attrs:{type:"text",autofocus:"",placeholder:e.selected[e.label]+" "+(void 0!=e.label2?e.selected[e.label2]:"")},domProps:{value:e.search_text},on:{input:function(t){t.target.composing||(e.search_text=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]):e._e(),s("div",{staticClass:"overflow-auto c-list rounded-b"},e._l(e.datas,(function(t,a){return s("div",{directives:[{name:"show",rawName:"v-show",value:e.match_search(t),expression:"match_search(d)"}],key:t[e.code],staticClass:" flex items-center cursor-pointer p-2 hover:bg-blue-500 hover:text-white",class:a==e.id_selected?"bg-blue-200 c-list-selected":"",attrs:{title:void 0!=e.title_sens?t[e.title_sens]:""},on:{click:function(t){return e.selection(a,t)}}},[s("span",{staticClass:"pr-2"},[e._v(" "+e._s(t[e.label])+" ")]),void 0!=e.label2?s("span",{staticClass:"whitespace-nowrap pr-2"},[e._v(" "+e._s(t[e.label2])+" ")]):e._e(),void 0!=e.title_sens?s("span",{staticClass:"pr-2"},[e._v(" ("+e._s(t[e.title_sens])+") ")]):e._e(),a==e.id_selected?s("span",{staticClass:"text-right material-icons flex-grow"},[e._v("check_circle")]):e._e()])})),0)]):e._e()])},b=[],g=(s("4d63"),s("c607"),s("2c3e"),s("25f0"),s("466d"),{watch:{clicked:function(e){if(e){var t=this;setTimeout((function(){$(".c-list").scrollTop(t.scrollT)}),300),window.addEventListener("click",this.hide)}else window.removeEventListener("click",this.hide)},datas:function(){this.id_selected=0,this.selected=this.datas[this.id_selected],this.$emit("selected",this.id_selected)}},methods:{selection:function(e,t){e!=this.id_selected&&(this.id_selected=e,this.selected=this.datas[this.id_selected],this.is_hover=!1,this.$emit("selected",this.id_selected),this.scrollT=$(".c-list").scrollTop()),this.clicked=!1},show:function(e){this.clicked=!0,this.currentTarget=e.currentTarget},hover:function(e){this.is_hover=e},hide:function(e){(null!=e.target.nextElementSibling||this.is_hover)&&(null==e.target.nextElementSibling||e.target.nextElementSibling.classList.contains("cselect-list"))||(this.clicked=!1)},test:function(){console.log("load")},match_search:function(e){if(""==this.search_text)return!0;var t=new RegExp(".?"+this.search_text+".?","gi");return null!=e[this.label].match(t)||void 0!=this.label2&&null!=e[this.label2].match(t)}},computed:{},props:["datas","label","label2","code","search","title_sens"],data:function(){return{selected:this.datas[0],id_selected:0,clicked:!1,currentTarget:null,scrollT:0,search_text:""}},created:function(){this.selected=this.datas[this.id_selected],this.$emit("selected",this.id_selected)},mounted:function(){}}),x=g,y=(s("b2e6"),Object(f["a"])(x,h,b,!1,null,"9a50e8b4",null)),C=y.exports,w={components:{ctable:n["a"],LeafletMap:v,cSelect:C},data:function(){return{places:{head:[{code:"lat",label:"Latitude"},{code:"lng",label:"Longitude"},{code:"radius",label:"Rayon (en mètre)"},{code:"label",label:"Libellé"}],list:[],model:{latlng:"",radius:50,label:""}},info:{success:"",message:"",isOn:!1,idTimeout:-1},on_add_place:!1,position_on_carte:[],current_position:[],current_place_name:"",search:""}},methods:{show_add_place:function(e){this.on_add_place=e},recup_place_list:function(){var e=this;this.$http.get("a/places").then((function(t){t.body.status&&(e.places.list=t.body.places)}),(function(e){}))},show_info:function(e,t,s){var a=this;this.info.message=t,this.info.isOn=!0,this.info.success=e,-1!=this.info.idTimeout&&clearTimeout(this.info.idTimeout),this.info.idTimeout=setTimeout((function(){a.info.isOn=!1,void 0!=s&&s()}),2e3)},post_add_place:function(){var e=this;this.$http.post("a/places",this.places.model).then((function(t){t.body.status?(e.show_info(t.body.status,t.body.message,(function(){e.show_add_place(!1)})),e.recup_place_list(),e.places.model={latlng:"",radius:50,label:""}):e.show_info(t.body.status,t.body.message)}),(function(e){}))},position:function(e){this.places.model.latlng=e.lat+","+e.lng},place_name:function(e){this.places.model.label=e},delete_place:function(e){var t=this,s=confirm("Voulez vous vraiment supprimer l'emplacement +"+this.places.list[e].label+" !!?");s&&this.$http.delete("a/places/"+this.places.list[e].id).then((function(e){e.body.status?(alert(e.body.message),t.recup_place_list()):alert(e.body.message)}),(function(e){}))},view_place:function(e){var t=this.places.list[e].id;this.$router.push({name:"vue_emplacement",params:{id:t}})}},created:function(){this.recup_place_list()}},k=w,j=Object(f["a"])(k,a,i,!1,null,null,null);t["default"]=j.exports},"845f":function(e,t,s){},"84eb":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"p-2"},[s("div",{},[s("div",{staticClass:"border-b mb-3 flex items-center pb-2"},[s("span",{staticClass:"text-xl text-gray-700 flex-grow "},[e._v(" Liste des utilisateurs - ")]),s("button",{staticClass:"ml-2 bt rounded-full flex justify-center items-center",on:{click:function(t){return e.show_add_user(!0)}}},[s("span",{staticClass:"material-icons"},[e._v(" add ")]),s("span",[e._v(" Ajouter ")])])]),s("div",{},[0!=e.users.list.length?s("ctable",{attrs:{_head:e.users.head,_list:e.users.list,_key:"login"},on:{on_view:e.view_user,on_delete:e.delete_user}}):s("div",{staticClass:"w-full flex justify-center items-center"},[s("span",{staticClass:"text-xl text-gray-600"},[e._v(" Aucun utiisateur à afficher. ")])])],1)]),e.on_add_user?s("div",{staticClass:"fixed flex justify-center items-center top-0 left-0 w-screen h-screen bg-gray-800 bg-opacity-80"},[s("div",{staticClass:"bg-gray-100 border flex flex-col border-green-400 rounded shadow-lg",style:{minWidth:"400px"}},[s("div",{staticClass:"border-b p-2 bg-green-400 flex"},[s("span",{staticClass:"flex-grow text-2xl text-gray-700 font-bold"},[e._v("Ajout d'un utilisateur")]),s("button",{staticClass:"w-8 h-8 rounded-full flex justify-center items-center text-gray-600\n                 hover:text-gray-800 duration-300",on:{click:function(t){return e.show_add_user(!1)}}},[s("span",{staticClass:"material-icons"},[e._v("clear")])])]),s("div",{staticClass:"duration-300 h-0 flex justify-center items-center",class:e.info.isOn?"h-14":"h-0"},[e.info.isOn?s("div",{staticClass:"rounded p-2 ",class:e.info.success?"bg-green-400":"bg-red-400"},[s("span",[e._v(" "+e._s(e.info.message)+" ")])]):e._e()]),s("form",{attrs:{action:"/",method:"post"},on:{submit:function(t){return t.preventDefault(),e.post_add_user.apply(null,arguments)}}},[s("div",{staticClass:"mt-2 p-2 flex"},[s("div",{staticClass:"flex flex-col pr-2"},[s("div",{staticClass:"mt-1 flex flex-col"},[s("span",{staticClass:"text-sm text-gray-600"},[e._v(" Nom ... ")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.users.model.nom,expression:"users.model.nom",modifiers:{trim:!0}}],staticClass:"input",attrs:{type:"text",placeholder:"Nom ..."},domProps:{value:e.users.model.nom},on:{input:function(t){t.target.composing||e.$set(e.users.model,"nom",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),s("div",{staticClass:"mt-1 flex flex-col"},[s("span",{staticClass:"text-sm text-gray-600"},[e._v(" Prénom ... ")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.users.model.prenom,expression:"users.model.prenom",modifiers:{trim:!0}}],staticClass:"input",attrs:{type:"text",placeholder:"Prénom ..."},domProps:{value:e.users.model.prenom},on:{input:function(t){t.target.composing||e.$set(e.users.model,"prenom",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),s("div",{staticClass:"mt-1 flex flex-col"},[s("span",{staticClass:"text-sm text-gray-600"},[e._v(" Login ... ")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.users.model.login,expression:"users.model.login",modifiers:{trim:!0}}],staticClass:"input",attrs:{type:"text",placeholder:"Login ..."},domProps:{value:e.users.model.login},on:{input:function(t){t.target.composing||e.$set(e.users.model,"login",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]),s("div",{staticClass:"pl-2 flex flex-col"},[s("div",{staticClass:"mt-1 flex flex-col"},[s("span",{staticClass:"text-sm text-gray-600"},[e._v(" Type ... ")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.users.model.type,expression:"users.model.type"}],staticClass:"input",attrs:{name:"",id:""},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.users.model,"type",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"admin"}},[e._v("Admin")]),s("option",{attrs:{value:"personel"}},[e._v("Personel")])])]),s("div",{staticClass:"mt-1 flex flex-col"},[s("span",{staticClass:"text-sm text-gray-600"},[e._v(" Mot de passe ... ")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.users.model.pass,expression:"users.model.pass"}],staticClass:"input",attrs:{type:"text",placeholder:"Mot de passe ..."},domProps:{value:e.users.model.pass},on:{input:function(t){t.target.composing||e.$set(e.users.model,"pass",t.target.value)}}})])])]),e._m(0)])])]):e._e()])},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"p-2 border-t flex justify-end"},[s("button",{staticClass:"bt-w rounded"},[e._v(" Créer ")])])}],n=s("ae38"),l={components:{ctable:n["a"]},data:function(){return{test_message:"",users:{head:[{code:"login",label:"Login"},{code:"prenom",label:"Prénom"},{code:"nom",label:"Nom"},{code:"type",label:"Type"}],list:[],model:{login:"",prenom:"",nom:"",pass:"",type:"personel"}},info:{success:"",message:"",isOn:!1,idTimeout:-1},on_add_user:!1}},methods:{init:function(){this.test_message="SAlut test de message",this.recup_user_list()},recup_user_list:function(){var e=this;this.$http.get("a/users").then((function(t){console.log(t.body),t.body.status&&(e.users.list=t.body.users)}),(function(e){}))},show_add_user:function(e){this.on_add_user=e},post_add_user:function(){var e=this;this.$http.post("a/users",e.users.model).then((function(t){t.body.status?(e.show_info(t.body.status,t.body.message,(function(){e.show_add_user(!1)})),e.recup_user_list()):e.show_info(t.body.status,t.body.message)}))},show_info:function(e,t,s){var a=this;this.info.message=t,this.info.isOn=!0,this.info.success=e,-1!=this.info.idTimeout&&clearTimeout(this.info.idTimeout),this.info.idTimeout=setTimeout((function(){a.info.isOn=!1,void 0!=s&&s()}),2e3)},view_user:function(e){},delete_user:function(e){var t=this.users.list[e],s=confirm("Voulez-vous vraiment supprimer l'utilisateur ayant l'identifiant "+t.login);if(s){var a=this;this.$http.delete("a/users/"+t.id).then((function(e){e.body.status?(a.recup_user_list(),alert(e.body.message)):alert(e.body.message)}),(function(e){}))}}},created:function(){this.init()}},r=l,o=s("2877"),c=Object(o["a"])(r,a,i,!1,null,null,null);t["default"]=c.exports},"9efe":function(e,t,s){"use strict";s("dbbf")},a968:function(e,t,s){"use strict";s("393f")},ae38:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",{staticClass:"w-full text-gray-700 rounded"},[s("thead",{staticClass:"rounded"},[s("tr",{staticClass:"text-left border-b bg-green-400 rounded-t"},[e._l(e._head,(function(t){return s("th",{key:t.label},[e._v(" "+e._s(t.label)+" ")])})),s("th")],2)]),s("tbody",e._l(e._list,(function(t,a){return s("tr",{directives:[{name:"show",rawName:"v-show",value:e.match_search(t),expression:"match_search(d)"}],key:t[e._key],staticClass:"cursor-pointer duration-300 hover:bg-blue-200 hover:bg-opacity-20 text-left bg-gray-300 bg-opacity-5 rounded-t",on:{click:function(t){return e.click_ligne(a)}}},[e._l(e._head,(function(a){return s("td",{key:a.label},[e._v(" "+e._s(t[a.code])+" ")])})),s("td",{staticClass:"flex justify-end items-center"},[s("button",{staticClass:"bt-icon mr-2",on:{click:function(t){return e.on_delete(a)}}},[s("span",{staticClass:"material-icons"},[e._v(" delete ")])]),s("button",{staticClass:"bt-icon mr-2",on:{click:function(t){return e.on_view(a)}}},[s("span",{staticClass:"material-icons"},[e._v(" open_in_full ")])])])],2)})),0)])},i=[],n=(s("ac1f"),s("841c"),s("4d63"),s("c607"),s("2c3e"),s("25f0"),s("466d"),{props:["_head","_list","_key","search","col_search"],data:function(){return{}},methods:{click_ligne:function(e){this.$emit("on_click",e)},on_delete:function(e){this.$emit("on_delete",e)},on_view:function(e){this.$emit("on_view",e)},match_search:function(e){if(void 0!=this.search||""!=this.search){var t=new RegExp(".?"+this.search+".?","gi");return null!=e[this.col_search].match(t)}return!0}}}),l=n,r=s("2877"),o=Object(r["a"])(l,a,i,!1,null,null,null);t["a"]=o.exports},b2e6:function(e,t,s){"use strict";s("ec0d")},dbbf:function(e,t,s){},e26c:function(e,t,s){"use strict";s.r(t);var a=s("8c4f"),i=[{path:"/",component:s("1384").default,name:"home"},{path:"/parametres",component:s("56d9").default,name:"settings"},{path:"/utilisateur",component:s("84eb").default,name:"user"},{path:"/emplacement",component:s("6fb8").default,name:"emplacement"},{path:"/emplacement/:id",component:s("f0fa").default,name:"vue_emplacement"},{path:"/stat",component:s("4efb").default,name:"stat"}];t["default"]=new a["a"]({routes:i})},ec0d:function(e,t,s){},f0fa:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{attrs:{id:"map"}}),s("div",{staticClass:"p-2 flex"},[s("div",{staticClass:"p-2"},[s("div",{staticClass:"p-2 mb-2 border bg-green-300 bg-opacity-10  rounded"},[s("span",[e._v("Latitude : ")]),e._v(" "),s("span",{staticClass:"font-bold"},[e._v(" "+e._s(e.place.lat)+" ")])]),s("div",{staticClass:"p-2 border bg-green-300 bg-opacity-10 rounded"},[s("span",[e._v("Logitude : ")]),e._v(" "),s("span",{staticClass:"font-bold"},[e._v(" "+e._s(e.place.lng)+" ")])])]),s("div",{staticClass:"p-2"},[s("div",{staticClass:"p-2 border bg-green-300 bg-opacity-10 rounded"},[s("span",[e._v(" Rayon (en mètre) : ")]),e._v(" "),s("span",{staticClass:"font-bold"},[e._v(" "+e._s(e.place.radius)+" ")])])]),s("div",{staticClass:"p-2"},[s("div",{staticClass:"p-2 border bg-green-300 bg-opacity-10 rounded"},[s("span",{},[e._v(" Libellé : ")]),e._v(" "),s("span",{staticClass:"font-bold"},[e._v(" "+e._s(e.place.label)+" ")])])])])])},i=[],n=s("1da1"),l=(s("96cf"),s("d81d"),{data:function(){return{radius:50,accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA",circle_l:null,features_circle:null,origin_view:[0,0],mymap:{},place:{}}},methods:{initmap:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=e,e.mymap=L.map("map").setView(e.origin_view,18),L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA"}).addTo(e.mymap),e.features_circle=L.featureGroup().addTo(e.mymap),s.features_circle.clearLayers(),s.circle_l=L.circle(e.origin_view,{color:"red",fillColor:"#f03",fillOpacity:.5,radius:e.radius}).bindPopup(e.place.label).addTo(e.features_circle),s.circle_l.openPopup(e.origin_view);case 7:case"end":return t.stop()}}),t)})))()},recup_emplacement:function(){var e=this;this.$http.get("a/places/"+this.$route.params.id).then((function(t){t.body.status?(e.place=t.body.place,e.origin_view=[e.place.lat,e.place.lng],e.radius=e.place.radius,e.initmap()):e.$router.push({name:"emplacement"})}),(function(e){alert("Erreur de Réseau")}))}},mounted:function(){this.recup_emplacement()}}),r=l,o=(s("9efe"),s("2877")),c=Object(o["a"])(r,a,i,!1,null,"0d2bd354",null);t["default"]=c.exports},ffad:function(e,t,s){"use strict";s("3bd8")}});
//# sourceMappingURL=index.51d84b03.js.map